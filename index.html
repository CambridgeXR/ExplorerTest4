<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>VR Explorer</title>

<!-- Manifest -->
<link rel="manifest" href="/ExplorerTest4/manifest.json">

<!-- iOS PWA -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="VR Explorer">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon" href="/ExplorerTest4/icons/icon-192.png">

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #000;
        color: #fff;
        text-align: center;
        overflow-x: hidden;
    }

    .container {
        margin-top: 40px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    h1 {
        font-size: 2.8rem;
        margin-bottom: 10px;
    }

    h2 {
        margin-top: 30px;
        font-size: 1.6rem;
        font-weight: 600;
    }

    select {
        width: 80%;
        max-width: 350px;
        padding: 14px;
        margin: 12px 0;
        font-size: 1.2rem;
        border-radius: 10px;
        border: none;
        outline: none;
        background: #111;
        color: white;
        appearance: none;
        cursor: pointer;
    }

    button#openBtn {
        margin-top: 25px;
        padding: 15px 25px;
        font-size: 1.3rem;
        color: #fff;
        background-color: #28a745;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        width: 80%;
        max-width: 350px;
    }

    footer {
        margin-top: 50px;
        font-size: 0.8rem;
        font-style: italic;
        opacity: 0.8;
    }

    /* VR Player */
    #playerWrap {
        position: fixed;
        inset: 0;
        display: none;
        background: #000;
        z-index: 1000;
        align-items: center;
        justify-content: center;
    }
    #playerWrap .cardboard {
        display: flex;
        width: 100%;
        height: 100%;
    }
    #playerWrap iframe {
        flex: 1;
        border: 0;
    }
    #playerWrap .player-toolbar {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 1010;
    }
    #playerWrap .player-toolbar button {
        padding: 8px 12px;
        border-radius: 8px;
        border: none;
        background: rgba(255,255,255,0.15);
        color: #fff;
        cursor: pointer;
    }
</style>
</head>
<body>

<div class="container" id="home">
    <h1>VR Explorer</h1>
    <h2>Step 1: Select Simulation</h2>

    <select id="audienceSelect">
        <option value="">Audience Sizes</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N0-CF">Audience of 0</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N1-CF">Audience of 1</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N2-CF">Audience of 2</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N4-CF">Audience of 4</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N9-CF">Audience of 9</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N16-CF">Audience of 16</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N25-CF">Audience of 25</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N50-CF">Audience of 50</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N100-CF">Audience of 100</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N500-CF">Audience of 500</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=N10K-CF">Audience of 1000s</option>
    </select>

    <select id="scenarioSelect">
        <option value="">Special Scenarios</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=ACC01-CF">TV teleprompter</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=JIC01-CF">Job interview</option>
        <option value="https://player.virtualrealitypublicspeaking.com/?video=RIC01-CF">Radio interview</option>
    </select>

    <button id="openBtn">Go</button>

    <footer>VR Explorer 1.1 brought to you by Cambridge VR</footer>
</div>

<div id="playerWrap">
    <div class="player-toolbar">
        <button id="exitBtn">Exit VR</button>
    </div>
    <div class="cardboard" id="playerArea"></div>
</div>

<script>
const audienceSel = document.getElementById("audienceSelect");
const scenarioSel = document.getElementById("scenarioSelect");
const openBtn = document.getElementById("openBtn");
const playerWrap = document.getElementById("playerWrap");
const playerArea = document.getElementById("playerArea");
const exitBtn = document.getElementById("exitBtn");

let selectedURL = "";

function updateSelection() {
    const audience = audienceSel.value;
    const scenario = scenarioSel.value;
    selectedURL = audience || scenario;
}

audienceSel.addEventListener("change", () => {
    scenarioSel.value = "";
    updateSelection();
});

scenarioSel.addEventListener("change", () => {
    audienceSel.value = "";
    updateSelection();
});

openBtn.addEventListener("click", () => {
    if (!selectedURL) { alert("Please select a simulation."); return; }
    openVR(selectedURL);
});

exitBtn.addEventListener("click", () => {
    closeVR();
});

function openVR(url) {
    playerArea.innerHTML = "";

    // Two iframes for Cardboard VR
    const left = document.createElement("iframe");
    const right = document.createElement("iframe");
    left.src = url;
    right.src = url;

    // Autoplay + VR allowed
    [left, right].forEach(f => {
        f.allow = "autoplay; fullscreen; accelerometer; gyroscope; xr-spatial-tracking";
    });

    playerArea.append(left, right);
    playerWrap.style.display = "flex";
}

function closeVR() {
    playerArea.innerHTML = "";
    playerWrap.style.display = "none";
}

// Register service worker
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/ExplorerTest4/sw.js");
}
</script>

</body>
</html>
